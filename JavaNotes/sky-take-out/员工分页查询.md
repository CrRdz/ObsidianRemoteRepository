# 需求分析和设计
业务规则
- 根据页码展示员工星系	
- 每页展示10条数据
- 分页查询可以根据需要 输入姓名进行查询
## 接口设计
- 基本信息
	- Path: /admin/employee/page
	- Method: GET
- 请求参数
	Query

| 参数名称     | 是否必须 | 示例  | 备注    |
| -------- | ---- | --- | ----- |
| name     | 否    | 张三  | 员工姓名  |
| page     | 是    | 1   | 页码    |
| pageSize | 是    | 10  | 每页记录数 |
- 返回数据

| 名称              | 类型           | 是否必须 | 默认值 | 备注  | 其他信息           |
| --------------- | ------------ | ---- | --- | --- | -------------- |
| code            | number       | 必须   |     |     |                |
| nsg             | null         | 非必须  |     |     |                |
| data            | object       | 必须   |     |     |                |
| ├─ total        | number       | 必须   |     |     |                |
| ├─ records      | object[]     | 必须   |     |     | item类型； object |
| │ ├─ id         | number       | 必须   |     |     |                |
| │ ├─ username   | string       | 必须   |     |     |                |
| │ ├─ name       | string       | 必须   |     |     |                |
| │ ├─ password   | string       | 必须   |     |     |                |
| │ ├─ phone      | string       | 必须   |     |     |                |
| │ ├─ sex        | string       | 必须   |     |     |                |
| │ ├─ idNumber   | string       | 必须   |     |     |                |
| │ ├─ Status     | number       | 必须   |     |     |                |
| │ ├─ createTime | string, null | 必须   |     |     |                |
| │ ├─ updateTime | string       | 必须   |     |     |                |
| │ ├─ createUser | number, null | 必须   |     |     |                |
| │ ├─ updateUser | number       | 必须   |     |     |                |
# 代码开发

根据分页查询接口设计的请求参数设计对应的DTO
```java
@Data  
public class EmployeePageQueryDTO implements Serializable {  
  
    //员工姓名  
    private String name;  
  
    //页码  
    private int page;  
  
    //每页显示记录数  
    private int pageSize;  
  
}
```

后面所有的分页查询 统一的封装成PageResult对象
```java
/**  
 * 封装分页查询结果  
 */  
@Data  
@AllArgsConstructor  
@NoArgsConstructor  
public class PageResult implements Serializable {  
  
    private long total; //总记录数  
  
    private List records; //当前页数据集合  
  
}
```

员工信息分页查询后端返回的对象类型为 `Result<PageResult>`

实用分页插件
```xml
<dependency>  
    <groupId>com.github.pagehelper</groupId>  
    <artifactId>pagehelper-spring-boot-starter</artifactId>  
    <version>${pagehelper}</version>  
</dependency>
```
底层基于MyBatis拦截器实现（动态拼SQL）

## `EmployeeController`

```java
/**  
 * 员工分页查询  
 * @param employeePageQueryDTO  
 * @return  
 */  
@GetMapping("/page")  
public Result<PageResult> page(EmployeePageQueryDTO employeePageQueryDTO) {  
    log.info("员工分页查询，参数为{}", employeePageQueryDTO);  
    PageResult pageResult = employeeService.pageQuery(employeePageQueryDTO);  
    return Result.success(pageResult);  
}
```

## `EmployeeService`

```java
/**  
 * 分页查询  
 * @param employeePageQueryDTO  
 * @return  
 */  
PageResult pageQuery(EmployeePageQueryDTO employeePageQueryDTO);
```

## `EmployeeServiceImpl`

```java
/**  
 * 分页查询  
 * @param employeePageQueryDTO  
 * @return  
 */  
@Override  
public PageResult pageQuery(EmployeePageQueryDTO employeePageQueryDTO) {  
    // select * from employee limit 0,10  
    //开始分页查询  
    PageHelper.startPage(employeePageQueryDTO.getPage(),employeePageQueryDTO.getPageSize());
  
    Page<Employee> page = employeeMapper.pageQuery(employeePageQueryDTO);  
  
    long total = page.getTotal();  
    List<Employee> records = page.getResult();  
  
    return new PageResult(total,records);  
}
```
你只需要关注业务数据的筛选，完全不用写 `LIMIT` 或 `OFFSET`，也不用手动写 count 查询。
PageHelper 帮你做的事 (拦截与修改): 当代码运行到 employeeMapper.pageQuery 时，PageHelper 会作为 MyBatis的插件介入。它检测到之前调用过 startPage，于是会做两件事：
自动修改 SQL: 它会在你的 SQL 后面自动追加数据库对应的分页语句（例如 MySQL 的 LIMIT 0, 10）。
自动 Count: 它会基于你的 SQL 自动生成一条 `SELECT COUNT(*)`语句并执行，用来计算总记录数 total。

## `EmployeeMapper`

```java
/**  
 * 分页查询  
 *  
 * @param employeePageQueryDTO  
 * @return  
 */  
Page<Employee> pageQuery(EmployeePageQueryDTO employeePageQueryDTO);
```

## `EmployeeMapper.xml`

```xml
<mapper namespace="com.sky.mapper.EmployeeMapper">  
    <select id="pageQuery" resultType="com.sky.entity.Employee">  
        select * from employee  
        <where>  
            <if test = "name != null and name !=''">  
                and name like concat('%',#{name},'%')  
            </if>  
        </where>  
        order by create_time desc  
    </select>  
</mapper>
```

# 功能测试
 前后端联调 + Swagger 测试