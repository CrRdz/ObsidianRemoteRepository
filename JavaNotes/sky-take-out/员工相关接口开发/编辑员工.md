# 需求分析和设计

编辑员工功能设计到两个接口
- 根据id查询员工信息
- 编辑员工信息

## 接口设计 - 根据id查询员工信息

- 基本信息
	- Path:/admin/employee/{id}
	- Method:GET
- 请求参数
	路径参数

| 参数名称 | 示例  | 备注  |
| ---- | --- | --- |
| id   |     | id  |
- 返回数据

| 名称            | 类型      | 是否必须 | 默认值 | 备注  | 其他信息             |
| ------------- | ------- | ---- | --- | --- | ---------------- |
| code          | integer | 必须   |     |     | format:int32     |
| data          | object  | 必须   |     |     |                  |
| ├─ id         | integer | 必须   |     |     | format:int64     |
| ├─ username   | string  | 必须   |     |     |                  |
| ├─ name       | string  | 必须   |     |     |                  |
| ├─ password   | string  | 必须   |     |     |                  |
| ├─ phone      | string  | 必须   |     |     |                  |
| ├─ sex        | string  | 必须   |     |     |                  |
| ├─ idNumber   | string  | 必须   |     |     |                  |
| ├─ status     | number  | 必须   |     |     | format:int32     |
| ├─ createTime | string  | 必须   |     |     | format:date-time |
| ├─ updateTime | string  | 必须   |     |     | format:date-time |
| ├─ createUser | integer | 必须   |     |     | format:int64     |
| ├─ updateUser | integer | 必须   |     |     | format:int64     |
| msg           | string  | 必须   |     |     |                  |
|               |         |      |     |     |                  |
## 接口设计 - 编辑员工信息

- 基本信息
	- Path:/admin/employee
	- Method:GET
- 请求参数
	Headers

| 参数名称         | 参数值              | 是否必须 | 示例  | 备注  |
| ------------ | ---------------- | ---- | --- | --- |
| Content-Type | application/json | 是    |     |     |
	Body
	

| 名称       | 类型      | 是否必须 | 默认值 | 备注  | 其他信息         |
| -------- | ------- | ---- | --- | --- | ------------ |
| id       | integer | 必须   |     |     | format：int64 |
| idNumber | string  | 必须   |     |     |              |
| name     | string  | 必须   |     |     |              |
| phone    | string  | 必须   |     |     |              |
| sex      | string  | 必须   |     |     |              |
| username | string  | 必须   |     |     |              |

	
- 返回数据

| 名称   | 类型      | 是否必须 | 默认值 | 备注  | 其他信息         |
| ---- | ------- | ---- | --- | --- | ------------ |
| code | integer | 必须   |     |     | format:int32 |
| data | object  | 非必必须 |     |     |              |
| msg  | string  | 非必须  |     |     |              |

# 代码开发 - 根据id查询员工信息

>在使用 `Result<T>` 这种统一返回结果类时，是否加泛型主要取决于**该接口是否需要向前端返回具体的业务数据（Data）**。

简单总结如下：

1. 需要加泛型的情况 (`Result<T>`)
**场景**：当接口的主要目的是**查询数据**或**获取资源**时。
**原因**：前端需要解析 `data` 字段中的具体内容（是一个对象列表、还是一个用户信息的 JSON ），加上泛型可以让 Swagger 接口文档清晰地展示返回结构，同时也保证了类型安全。

*   **你的代码示例：**
    *   `login()`: 返回 `Result<EmployeeLoginVO>`。因为登录成功后，前端需要拿到 Token、ID 和用户名。
    *   `page()`: 返回 `Result<PageResult>`。前端需要拿到分页列表数据和总记录数。
    *   `getById()`: 返回 `Result<Employee>`。前端回显数据时需要具体的员工信息。

2. 不需要加泛型的情况 (直接用 `Result`)
**场景**：当接口的主要目的是**执行动作**（增、删、改），且只需要告诉前端“操作成功”还是“失败”时。
**原因**：这些操作通常不需要返回额外的数据，只要 HTTP 状态码为 200 且业务 Code 为成功即可。此时 `data` 字段通常为 `null`。

*   **你的代码示例：**
    *   `save()` (新增): 只需要告知保存成功，由 `Result.success()` 返回即可。
    *   `update()` (修改): 同上。
    *   `startOrStop()` (状态及禁用): 同上。

## `EmployeeController`

```java
/**  
 * 根据id查询员工信息  
 * @param id  
 * @return  
 */  
@GetMapping("/{id}")  
@ApiOperation("根据id查询员工信息")  
public Result<Employee> getById(@PathVariable Long id) {  
    Employee employee = employeeService.getById(id);  
    return Result.success(employee);  
}
```

## `EmployeeService`

```java
/**  
 * 根据id查询员工信息  
 * @param id  
 * @return  
 */  
Employee getById(Long id);
```
## `EmployeeServiceImpl`

```java
@Override  
public Employee getById(Long id) {  
    Employee employee = employeeMapper.getById(id);  
    employee.setPassword("****");  
    return employee;  
}
```

## `EmployeeMapper`

```java
/**  
 * 根据id查询员工信息  
 * @param id  
 * @return  
 */  
@Select("select * from employee where id = #{id}")  
Employee getById(Long id);
```
# 代码开发 - 编辑员工信息
## `EmployeeController`

```java
@PutMapping  
@ApiOperation("修改员工信息")  
public Result update(@RequestBody EmployeeDTO employeeDTO) {  
    log.info("修改员工信息:{}",employeeDTO);  
    employeeService.update(employeeDTO);  
    return Result.success();  
}
```

## `EmployeeService`

```java
/**  
 * 修改员工信息  
 * @param employeeDTO  
 */  
void update(EmployeeDTO employeeDTO);
```

## `EmployeeServiceImpl`

```java
/**  
 * 修改员工信息  
 * @param employeeDTO  
 */  
@Override  
public void update(EmployeeDTO employeeDTO) {  
    Employee employee = new Employee();  
    BeanUtils.copyProperties(employeeDTO,employee);  
  
    employee.setUpdateTime(LocalDateTime.now());  
    employee.setUpdateUser(BaseContext.getCurrentId());  
  
    employeeMapper.update(employee);  
}
```

其中复用Mapper层中的 update
# 功能测试
 前后端联调 + Swagger 测试
