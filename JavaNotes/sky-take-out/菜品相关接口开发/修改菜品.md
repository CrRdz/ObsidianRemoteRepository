# 需求分析和设计

## 接口设计-根据id查询菜品
- 基本信息
	- Path: /admin/dish/{id}
	- Method:GET
- 请求参数
	路径参数

| 参数名称 | 示例  | 备注   |
| ---- | --- | ---- |
| id   | 101 | 菜品id |
- 返回数据

| 名称             | 类型       | 是否必须 | 默认值 | 备注  | 其他信息           |
| -------------- | -------- | ---- | --- | --- | -------------- |
| code           | number   | 必须   |     |     |                |
| data           | object   | 非必须  |     |     | formata:int64  |
| ├─ categoryId  | integer  | 非必须  |     |     |                |
| ├─ description | string   | 非必须  |     |     |                |
| ├─ flavors     | object[] | 非必须  |     |     | item 类型：object |
| │ ├─ dishId    | integer  | 非必须  |     |     | formata:int64  |
| │ ├─ id        | integer  | 非必须  |     |     | formata:int64  |
| │ ├─ name      | string   | 非必须  |     |     |                |
| │ ├─ value     | string   | 非必须  |     |     |                |
| ├─ id          | integer  | 非必须  |     |     | formata:int64  |
| ├─ image       | string   | 非必须  |     |     |                |
| ├─ name        | string   | 非必须  |     |     |                |
| ├─ price       | number   | 非必须  |     |     |                |
| msg            | string   | 非必须  |     |     |                |


- 根据类型查询分类（已实现）
- 文件上传（已实现）
## 接口设计-修改菜品
- 基本信息
	- Path:/admin/dish
	- Method:PUT
- 请求参数
	Headers
	
| 参数名称         | 参数值              | 是否必须 | 示例  | 备注  |
| ------------ | ---------------- | ---- | --- | --- |
| Content-type | application/json | 是    |     |     |
	Body
	
| 名称          | 类型       | 是否必须 | 默认值 | 备注  | 其他信息           |
| ----------- | -------- | ---- | --- | --- | -------------- |
| categoryId  | integer  | 必须   |     |     | format：int64   |
| description | string   | 非必须  |     |     |                |
| flavors     | object[] | 必须   |     |     | item 类型：object |
| ├─ dishId   | integer  | 必须   |     |     | format：int64   |
| ├─ id       | integer  | 必须   |     |     | format：int64   |
| ├─ name     | string   | 必须   |     |     |                |
| ├─ value    | string   | 必须   |     |     |                |
| id          | integer  | 必须   |     |     | format：int64   |
| image       | string   | 必须   |     |     |                |
| name        | string   | 必须   |     |     |                |
| price       | number   | 必须   |     |     |                |
| status      | integer  | 必须   |     |     | format：int32   |
- 返回数据

| 名称   | 类型      | 是否必须 | 默认值 | 备注  | 其他信息         |
| ---- | ------- | ---- | --- | --- | ------------ |
| code | integer | 必须   |     |     | format：int32 |
| data | string  | 非必须  |     |     |              |
| msg  | string  | 非必须  |     |     |              |
# 代码开发-根据id查询菜品
## `DishController`

```java
@GetMapping("/{id}")  
@ApiOperation("根据id查询菜品及其口味信息")  
public Result<DishVO> getById(@PathVariable Long id) {  
    log.info("根据id查询菜品及其口味信息：{}", id);  
    DishVO dishVO = dishService.getByIdWithFlavor(id);  
    return Result.success(dishVO);  
}
```
## `DishService`

```java
/**  
 * 根据id查询菜品及其口味信息  
 * @param id  
 * @return  
 */  
DishVO getByIdWithFlavor(Long id);
```
## `DishServiceImpl`

```java
@Override  
public DishVO getByIdWithFlavor(Long id) {  
    // 根据id查询菜品基本信息  
    Dish dish = dishMapper.getById(id);  
  
    // 根据dishId查询对应的口味信息  
    List<DishFlavor> dishFlavors = dishFlavorMapper.getByDishId(id);  
  
    // 封装成DishVO对象并返回  
    DishVO dishVO = new DishVO();  
    BeanUtils.copyProperties(dish, dishVO);  
    dishVO.setFlavors(dishFlavors);  
  
    return dishVO;  
}
```
## `DishFlavorMapper`

```java
/**  
 * 根据菜品id查询对应的口味数据  
 * @param dishId  
 * @return  
 */  
@Select("select * from dish_flavor where dish_id = #{dishId}")  
List<DishFlavor> getByDishId(Long dishId);
```
## `DishMapper`

[[删除菜品#^f98ec3| getById]]
